<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Yao's Blog</title>
  <meta name="description" content="Yao's blog on everything about web technologies'">

  <link rel="stylesheet" href="/public/css/main.css">
  <link rel="canonical" href="https://yaodingyd.github.io/">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/black/pace-theme-flash.min.css" />
  
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://yaodingyd.github.io">
  <meta property="og:title" content="Yao's Blog">
  <meta property="og:image" content="">
  <meta property="og:description" content="Yao's blog on everything about web technologies">
  <meta property="og:site_name" content="Yao's Blog">
  <meta property="og:locale" content="en_US">
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@">
  <meta name="twitter:creator" content="@YaoDingSD">
  <meta name="twitter:url" content="https://yaodingyd.github.io">
  <meta name="twitter:title" content="Yao's Blog">
  <meta name="twitter:description" content="Yao's blog on everything about web technologies">
  <meta name="twitter:image" content="https://example.com/image.jpg">


  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-86352654-1', 'auto');
  ga('send', 'pageview');
  </script>
</head>

  <body class="site">

        <header class="header" role="banner">
    <a class="header__avatar" href="/">
        <img class="header__avatar-img" src="/resource/avatar.jpg">
    </a>
    <nav class="header__nav">
        <a class="header__nav-link" href="/">Blog</a>
        <a class="header__nav-link" href="/project/">Project</a>
        <a class="header__nav-link" href="/note/">Note</a>
        <a class="header__nav-link" href="/about/">About</a>
    </nav>
</header>

        <main id="barba-wrapper" class="site__content" aria-label="Content">
          <div class="barba-container">
          <div class="container">
  <article class="post" itemtype="http://schema.org/BlogPosting">  
    <header class="post__header">
      <h1 class="title" itemprop="name headline">Security: CSP and CORS</h1>
      <div class="post__meta">
        <time class="post__time">Jul 19, 2017</time>
          
          
            <a href="/tag#web-fundamental" class="post__tag">Web Fundamental</a>
          
        
      </div>
    </header>

    <div class="post__content" itemprop="articleBody">
      <p>Today when I was working, I checked console log and saw 146 errors of something like this:</p>

<blockquote>
  <p>[Report Only] Refused to load the stylesheet ‘http://example.com’ because it violates the following Content Security Policy directive: “default-src https: ‘unsafe-inline’ ‘unsafe-eval’”. Note that ‘style-src’ was not explicitly set, so ‘default-src’ is used as a fallback.</p>
</blockquote>

<p>Then I noticed there is a new item in header: <code class="highlighter-rouge">Content-Security-Policy-Report-Only:default-src https: 'unsafe-inline' 'unsafe-eval'; report-uri https://example.com/reportingEndpoint</code>. This enables <em>Content Security Policy</em>, which in the case, report error only and doesn’t really block resources from loading.</p>

<h2 id="what-is-content-security-policy">What is Content Security Policy</h2>

<p>According to MDN:</p>

<blockquote>
  <p>Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks. These attacks are used for everything from data theft to site defacement or distribution of malware.</p>
</blockquote>

<p>To use CSP, we can either enable this in the server side, that means adding a <code class="highlighter-rouge">Content-Security-Policy</code> HTTP header, or use <code class="highlighter-rouge">&lt;meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src https://*; child-src 'none';"&gt;</code> meta tags in the HTML.</p>

<h2 id="whats-difference-with-cors">What’s difference with CORS?</h2>

<p>Same Origin Policy is the default policy for all browsers and it limits that a resource makes a cross-origin HTTP request when it requests a resource from a different domain, protocol, or port to its own. Basically when doing <code class="highlighter-rouge">XMLHttpRequest</code> or <code class="highlighter-rouge">fetch</code>, you have to enable CORS for different origin, but not loading <code class="highlighter-rouge">script</code> or <code class="highlighter-rouge">img</code> tag when document first loads.</p>


    </div>
  </article>

  <div class="page-navigation">
    
      <a class="page__prev" href="/blog/about-cropping-image/">&laquo; About Cropping Image</a>
    
    
      <a class="page__next" href="/blog/reading-vue-source-code/">Reading Vue's Source Code &raquo;</a>
    
  </div>
</div>

          </div>
        </main>

        <footer class="footer" id="barba-footer">
  <div class="footer__title">Yao Ding</div>
  <div class="footer__links">
      <a class="footer__link" href="mailto:yaodingyd@gmail.com">Email</a>
      <a  class="footer__link" href="https://github.com/yaodingyd">Github</a>
  </div>
</footer>

<!-- <script src="/public/js/src.js"></script> -->


  </body>
</html>
